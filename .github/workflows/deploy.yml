name: Deploy to Render

on:
  push:
    branches:
      - master

jobs:
  deploy:
    runs-on: ubuntu-latest

    env:
      NODE_ENV: production

    steps:
      # 1Ô∏è‚É£ R√©cup√©rer le code
      - name: Checkout code
        uses: actions/checkout@v3

      # 2Ô∏è‚É£ Installer Render CLI via npm (pas unzip)
      - name: Install Render CLI
        run: |
          npm install -g @render/cli
          render --version

      # 3Ô∏è‚É£ D√©ploiement sur Render
      - name: Deploy to Render
        env:
          RENDER_API_KEY: ${{ secrets.RENDER_API_KEY }}
        run: |
          echo "üöÄ D√©ploiement sur Render..."
          render deploys create ${{ secrets.RENDER_SERVICE_ID }} --confirm
          echo "‚úÖ D√©ploiement termin√© avec succ√®s !"